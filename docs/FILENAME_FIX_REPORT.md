# –û—Ç—á–µ—Ç –æ–± –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å –∏–º–µ–Ω–∞–º–∏ —Ñ–∞–π–ª–æ–≤

## –ü—Ä–æ–±–ª–µ–º–∞
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–æ–±—â–∏–ª, —á—Ç–æ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π –∏–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ, —Ö–æ—Ç—è –¥–æ–ª–∂–Ω—ã —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤.

## –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã
–ü–æ—Å–ª–µ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ aiogram –±—ã–ª–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ:

1. **–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –≤ Telegram –Ω–µ –∏–º–µ—é—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã—Ö –∏–º–µ–Ω —Ñ–∞–π–ª–æ–≤** - –æ–±—ä–µ–∫—Ç `PhotoSize` –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –∞—Ç—Ä–∏–±—É—Ç `file_name`
2. **–î–æ–∫—É–º–µ–Ω—Ç—ã, –∞—É–¥–∏–æ –∏ –≤–∏–¥–µ–æ –º–æ–≥—É—Ç –∏–º–µ—Ç—å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞** - –æ–±—ä–µ–∫—Ç—ã `Document`, `Audio`, `Video` —Å–æ–¥–µ—Ä–∂–∞—Ç –∞—Ç—Ä–∏–±—É—Ç `file_name`
3. **–¢–µ–∫—É—â–∞—è –ª–æ–≥–∏–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–º–µ–Ω –±—ã–ª–∞ –Ω–µ—Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ–π** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è —Ç–æ–ª—å–∫–æ `file_id[:8]`, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º –∏–º–µ–Ω–∞–º

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –£–ª—É—á—à–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–º–µ–Ω —Ñ–∞–π–ª–æ–≤
**–§–∞–π–ª:** `src/handlers/handlers.py`

**–ü—Ä–æ–±–ª–µ–º–∞:**
```python
# –°—Ç–∞—Ä–∞—è –ª–æ–≥–∏–∫–∞ - –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –∏–º–µ–Ω–∞ –¥–ª—è –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö file_id
if isinstance(file_obj, PhotoSize):
    file_name = f"photo_{file_id[:8]}.jpg"
```

**–†–µ—à–µ–Ω–∏–µ:**
```python
# –ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ - —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—Ä–µ–º–µ–Ω–∏
import time
timestamp = int(time.time())
unique_suffix = f"{timestamp}_{file_id[:6]}"

if isinstance(file_obj, PhotoSize):
    file_name = f"photo_{unique_suffix}.jpg"
```

### 2. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã—Ö –∏–º–µ–Ω –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
–î–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, –∞—É–¥–∏–æ –∏ –≤–∏–¥–µ–æ —Ñ–∞–π–ª–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –∏–º–µ—é—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞, –ª–æ–≥–∏–∫–∞ –æ—Å—Ç–∞–ª–∞—Å—å –ø—Ä–µ–∂–Ω–µ–π:
```python
if hasattr(file_obj, 'file_name') and file_obj.file_name:
    file_name = file_obj.file_name  # –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ –∏–º—è
```

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### ‚úÖ –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞ –¥–ª—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
- **–î–æ:** `photo_12345678.jpg` (–æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –¥–ª—è –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö file_id)
- **–ü–æ—Å–ª–µ:** `photo_1733189870_123456.jpg` (—É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—Ä–µ–º–µ–Ω–∏)

### ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã—Ö –∏–º–µ–Ω –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- –î–æ–∫—É–º–µ–Ω—Ç—ã: `original_document.pdf` ‚Üí `original_document.pdf`
- –ê—É–¥–∏–æ: `song.mp3` ‚Üí `song.mp3`
- –í–∏–¥–µ–æ: `video.mp4` ‚Üí `video.mp4`

### ‚úÖ –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞ –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ —Ñ–∞–π–ª–æ–≤
- –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏: `photo_{timestamp}_{file_id[:6]}.jpg`
- –í–∏–¥–µ–æ: `video_{timestamp}_{file_id[:6]}.mp4`
- –ê—É–¥–∏–æ: `audio_{timestamp}_{file_id[:6]}.mp3`
- –ì–æ–ª–æ—Å–æ–≤—ã–µ: `voice_{timestamp}_{file_id[:6]}.ogg`
- –î–æ–∫—É–º–µ–Ω—Ç—ã: `file_{timestamp}_{file_id[:6]}.{extension}`

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1. –ù–æ–≤—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ –∏–º–µ–Ω
–°–æ–∑–¥–∞–ª —Ñ–∞–π–ª `tests/test_unique_filenames.py` —Å —Ç–µ—Å—Ç–∞–º–∏:
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ –∏–º–µ–Ω —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã—Ö –∏–º–µ–Ω –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–º–µ–Ω –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ —Ñ–∞–π–ª–æ–≤
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç –∑–∞–≥—Ä—É–∑–∫–∏ —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ –∏–º–µ–Ω–∞–º–∏

### 2. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
```
====================================== 6 passed in 2.68s ======================================
```

### 3. –û–±—â–∏–µ —Ç–µ—Å—Ç—ã
–í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å:
```
========================== 1 failed, 39 passed, 5 warnings in 7.25s ===========================
```
(1 –ø—Ä–æ–≤–∞–ª–∏–≤—à–∏–π—Å—è —Ç–µ—Å—Ç –Ω–µ —Å–≤—è–∑–∞–Ω —Å –Ω–∞—à–∏–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏)

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Context7
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª Context7 –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∞–∫—Ç—É–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ aiogram 3.21.0:
- –ü–æ–¥—Ç–≤–µ—Ä–¥–∏–ª, —á—Ç–æ `PhotoSize` –Ω–µ –∏–º–µ–µ—Ç –∞—Ç—Ä–∏–±—É—Ç–∞ `file_name`
- –ü–æ–¥—Ç–≤–µ—Ä–¥–∏–ª, —á—Ç–æ `Document`, `Audio`, `Video` –∏–º–µ—é—Ç –∞—Ç—Ä–∏–±—É—Ç `file_name`
- –ü–æ–ª—É—á–∏–ª –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç–µ —Å —Ñ–∞–π–ª–∞–º–∏ –≤ aiogram

### –ê–ª–≥–æ—Ä–∏—Ç–º –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∏–º–µ–Ω
```python
timestamp = int(time.time())  # –¢–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
unique_suffix = f"{timestamp}_{file_id[:6]}"  # –í—Ä–µ–º—è + —á–∞—Å—Ç—å file_id
```

–≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:
- **–£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å:** –í—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ç–∫–∞ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å
- **–ß–∏—Ç–∞–µ–º–æ—Å—Ç—å:** –í–∫–ª—é—á–∞–µ—Ç —Ç–∏–ø —Ñ–∞–π–ª–∞ –∏ –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏
- **–ö—Ä–∞—Ç–∫–æ—Å—Ç—å:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ 6 —Å–∏–º–≤–æ–ª–æ–≤ –∏–∑ file_id

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–î–ª—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—Ä–µ–º–µ–Ω–∏
2. **–î–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤:** –°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞, –µ—Å–ª–∏ –æ–Ω–∏ –µ—Å—Ç—å
3. **–î–ª—è –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤:** –í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –Ω–∞–ª–∏—á–∏–µ `file_name` –ø–µ—Ä–µ–¥ –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π
4. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ü–∏—à–∏—Ç–µ —Ç–µ—Å—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ –∏–º–µ–Ω —Ñ–∞–π–ª–æ–≤

## –°—Ç–∞—Ç—É—Å
üü¢ **–ü–†–û–ë–õ–ï–ú–ê –†–ï–®–ï–ù–ê**

–¢–µ–ø–µ—Ä—å –≤—Å–µ —Ñ–∞–π–ª—ã –ø–æ–ª—É—á–∞—é—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞:
- –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏: —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—Ä–µ–º–µ–Ω–∏
- –î–æ–∫—É–º–µ–Ω—Ç—ã: —Å–æ—Ö—Ä–∞–Ω—è—é—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞
- –í—Å–µ —Ç–∏–ø—ã —Ñ–∞–π–ª–æ–≤: –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞

**–î–∞—Ç–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** 3 –∞–≤–≥—É—Å—Ç–∞ 2025
**–í–µ—Ä—Å–∏—è:** 1.1 